{% extends "bootstrap/base.html" %}

{% block title %}
Dashboard
{% endblock %}

{% block styles %}
{{super()}}
<link rel="stylesheet" href="{{url_for('static', filename='dashboard.css')}}">
{% endblock %}

{% block content %}
{% include 'includes/_navbar_top.html' %}

<div class="container-fluid">
  <div class="row">
    <div class="col-md-12">
      <h1 class="page-header">Table: {{ dataset_info.name }}</h1>
      <form method=post>
        <table class="table table-striped table-condensed">
          <thead>
            <tr>
            <th></th>
              {% for cname in cnames %}
              <th>{{ cname }}</th>
              {% endfor %}
            </tr>
          </thead>
          <tbody>
            {% for row in data.items %}
            <tr>
            <td>
                 <label class="custom-control custom-checkbox">
                     <input type="checkbox" name="data_id[]" class="custom-control-input" value={{row[0]}}>
                     <span class="custom-control-indicator"></span>
                 </label>
            </td>
              {% for element in row %}
              <td>{{ element }}</td>
              {% endfor %}
            </tr>
            {% endfor %}
          </tbody>
        </table>
    <input onclick="this.form.action='{{url_for('data_bp.delete', id=dataset_info.id)}}'; this.form.submit()" class="btn btn-primary float-right" value="Delete">
      </form>
    </div>
  </div>
  <div class="row">
    <nav aria-label="Page navigation">
        <div>
            Results per page
            <form action='{{url_for(request.endpoint)}}'>
                <select name=resultsperpage onchange="this.form.submit()">
                    {% for i in [10,25,50,100] %}
                    <option {% if i == resultsperpage %} selected {% endif %} value="{{i}}">{{i}}</option>
                    {% endfor %}
                </select>
                <input hidden name=dataset value={{dataset_info.id}}>
                <input hidden name=page value=1>
            </form>
        </div>
        <div>
            Go to page
            <form action='{{url_for(request.endpoint)}}'>
                <input name=page value={{data.page}} type=number>
                <input hidden name=dataset value={{dataset_info.id}}>
                <input hidden name=resultsperpage value={{resultsperpage}}>
                <input hidden type=submit>
            </form>
        </div>
      <ul class="pagination">
          <li><a href="{{ url_for(request.endpoint, dataset=dataset_info.id, page=1, resultsperpage=resultsperpage) }}">1</a></li>
        {% for i in range((data.page-2, 2)|max,(data.pages, data.page+3)|min) %}
        {% if i == data.page %}
        <li class="active"><a href="#">{{ i }}</a></li>
        {% else %}
        <li><a href="{{ url_for(request.endpoint, dataset=dataset_info.id, page=i, resultsperpage=resultsperpage) }}">{{ i }}</a></li>
        {% endif %}
        {% endfor %}
        <li><a href="{{ url_for(request.endpoint, dataset=dataset_info.id, page=data.pages, resultsperpage=resultsperpage) }}">{{data.pages}}</a></li>
      </ul>
    </nav>
  </div>
</div>
{% endblock %}
